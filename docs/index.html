<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PythonTradeApp</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 10px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { background: #333; color: white; padding: 15px; text-align: center; margin-bottom: 15px; border-radius: 8px; }
        .columns { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .panel { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        
        /* Mobile responsive design */
        @media (max-width: 768px) {
            body { margin: 5px; }
            .columns { grid-template-columns: 1fr; gap: 10px; }
            .panel { padding: 12px; }
            header { padding: 12px; }
            header h1 { font-size: 1.5em; margin: 5px 0; }
            header p { font-size: 0.9em; margin: 0; }
        }
        h3 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 5px; }
        button { background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 6px; margin: 5px; cursor: pointer; font-size: 14px; min-height: 44px; transition: background-color 0.2s; }
        button:hover, button:active { background: #0056b3; }
        .sell { background: #dc3545; }
        .sell:hover, .sell:active { background: #c82333; }
        .reset { background: #6c757d; }
        .reset:hover, .reset:active { background: #5a6268; }
        input, select { width: 100%; padding: 12px; margin: 5px 0; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; box-sizing: border-box; }
        
        /* Mobile button improvements */
        @media (max-width: 768px) {
            button { padding: 14px 16px; margin: 3px; width: calc(50% - 6px); font-size: 16px; }
            .reset { width: 100%; margin-top: 10px; }
            input, select { padding: 14px; font-size: 16px; }
        }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; overflow-x: auto; }
        th, td { padding: 8px 4px; border-bottom: 1px solid #ddd; text-align: left; font-size: 14px; }
        th { background: #f8f9fa; font-weight: bold; }
        .price { background: #e3f2fd; padding: 15px; text-align: center; margin: 10px 0; font-size: 1.2em; border-radius: 6px; font-weight: bold; }
        
        /* Mobile table improvements */
        @media (max-width: 768px) {
            table { font-size: 12px; }
            th, td { padding: 6px 3px; }
            .price { font-size: 1.1em; padding: 12px; }
            h3 { font-size: 1.1em; margin: 15px 0 10px 0; }
        }
        .message { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        footer { 
            background: #333; 
            color: #fff; 
            padding: 25px; 
            text-align: center; 
            margin-top: 40px; 
            border-radius: 8px;
            display: block;
            clear: both;
            width: 100%;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            box-sizing: border-box;
            position: relative;
        }
        footer p { 
            margin: 12px 0; 
            line-height: 1.6; 
            color: #fff;
            display: block;
            font-size: 16px;
        }
        footer a { 
            color: #87CEEB; 
            text-decoration: none; 
            transition: color 0.2s ease;
        }
        footer a:hover, footer a:active { 
            color: #ADD8E6; 
            text-decoration: underline; 
        }
        footer strong { 
            color: #ffffff; 
            font-weight: bold;
        }
        footer small { 
            opacity: 0.85; 
            color: #ccc;
            font-size: 14px;
        }
        
        /* Mobile footer and chart */
        @media (max-width: 768px) {
            footer { 
                padding: 15px !important; 
                margin-top: 20px !important; 
                margin-left: 0 !important;
                margin-right: 0 !important;
                border-radius: 6px !important;
            }
            footer p { 
                font-size: 14px !important; 
                margin: 8px 0 !important; 
            }
            footer small { font-size: 12px; }
            #chart { height: 250px !important; }
            canvas { touch-action: pan-x pan-y; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>�� PythonTradeApp</h1>
            <p>Interactive Trading Simulator</p>
        </header>

        <div id="messages"></div>

        <div class="columns">
            <div class="panel">
                <h3>Stock Selection</h3>
                <select id="symbol">
                    <option value="AAPL">AAPL - Apple</option>
                    <option value="MSFT">MSFT - Microsoft</option>
                </select>

                <div class="price" id="price">AAPL: $225.77</div>

                <h3>Chart</h3>
                <canvas id="chart" style="height: 300px;"></canvas>
            </div>

            <div class="panel">
                <h3>Account</h3>
                <p>Cash: $<span id="cash">100,000</span></p>
                <p>Portfolio: $<span id="portfolio">0</span></p>

                <h3>Positions</h3>
                <table>
                    <thead><tr><th>Symbol</th><th>Shares</th><th>Avg</th><th>Value</th></tr></thead>
                    <tbody id="positions"><tr><td colspan="4">No positions</td></tr></tbody>
                </table>

                <h3>Trade</h3>
                <input type="number" id="qty" value="10" min="1">
                <button onclick="trade('buy')">Buy</button>
                <button class="sell" onclick="trade('sell')">Sell</button>

                <h3>Recent Trades</h3>
                <table>
                    <thead><tr><th>Time</th><th>Side</th><th>Symbol</th><th>Qty</th><th>Price</th></tr></thead>
                    <tbody id="trades"><tr><td colspan="5">No trades</td></tr></tbody>
                </table>

                <button class="reset" onclick="reset()">Reset Account</button>
            </div>
        </div>

        <footer>
            <p><strong>PythonTradeApp</strong> - Interactive Trading Simulator</p>
            <p>Built with Chart.js | Data stored locally in your browser</p>
            <p>
                <a href="https://github.com/shaw2024/pythontradeapp" target="_blank">GitHub Repository</a> | 
                <a href="https://github.com/shaw2024" target="_blank">Developer</a>
            </p>
            <p><small>&copy; 2025 PythonTradeApp. Educational purposes only - not real trading.</small></p>
        </footer>
    </div>

    <script>
        const data = {
            AAPL: { 
                dates: ['Oct 1', 'Oct 2', 'Oct 3', 'Oct 4', 'Oct 5'], 
                prices: [225.77, 226.47, 225.67, 226.80, 224.63] 
            },
            MSFT: { 
                dates: ['Oct 1', 'Oct 2', 'Oct 3', 'Oct 4', 'Oct 5'], 
                prices: [416.06, 415.26, 414.78, 418.22, 413.49] 
            }
        };
        let symbol = 'AAPL', chart = null;

        function getAccount() {
            return JSON.parse(localStorage.getItem('account') || '{"cash":100000,"positions":{},"trades":[]}');
        }
        function saveAccount(acc) { 
            localStorage.setItem('account', JSON.stringify(acc)); 
        }
        function getPrice(s) { 
            return data[s].prices[data[s].prices.length-1]; 
        }
        function msg(text, type='success') {
            document.getElementById('messages').innerHTML = '<div class="message ' + type + '">' + text + '</div>';
            setTimeout(function() { document.getElementById('messages').innerHTML = ''; }, 4000);
        }

        function update() {
            const acc = getAccount();
            const price = getPrice(symbol);
            document.getElementById('price').textContent = symbol + ': $' + price;
            document.getElementById('cash').textContent = acc.cash.toFixed(0);

            let portValue = 0;
            const posTable = document.getElementById('positions');
            if (Object.keys(acc.positions).length === 0) {
                posTable.innerHTML = '<tr><td colspan="4">No positions</td></tr>';
            } else {
                let html = '';
                for (const sym in acc.positions) {
                    const pos = acc.positions[sym];
                    if (pos.qty > 0) {
                        const val = pos.qty * getPrice(sym);
                        portValue += val;
                        html += '<tr><td>' + sym + '</td><td>' + pos.qty + '</td><td>$' + pos.avg.toFixed(2) + '</td><td>$' + val.toFixed(0) + '</td></tr>';
                    }
                }
                posTable.innerHTML = html;
            }
            document.getElementById('portfolio').textContent = portValue.toFixed(0);

            const tradeTable = document.getElementById('trades');
            if (acc.trades.length === 0) {
                tradeTable.innerHTML = '<tr><td colspan="5">No trades</td></tr>';
            } else {
                let html = '';
                const recent = acc.trades.slice(-3).reverse();
                for (let i = 0; i < recent.length; i++) {
                    const t = recent[i];
                    html += '<tr><td>' + new Date(t.time).toLocaleTimeString() + '</td><td>' + t.side + '</td><td>' + t.symbol + '</td><td>' + t.qty + '</td><td>$' + t.price + '</td></tr>';
                }
                tradeTable.innerHTML = html;
            }
        }

        function trade(action) {
            const acc = getAccount();
            const qty = parseInt(document.getElementById('qty').value) || 0;
            const price = getPrice(symbol);
            if (qty <= 0) return msg('Invalid quantity', 'error');

            if (action === 'buy') {
                const cost = price * qty;
                if (acc.cash < cost) return msg('Need $' + cost + ', have $' + acc.cash.toFixed(0), 'error');

                if (!acc.positions[symbol]) acc.positions[symbol] = {qty: 0, avg: 0};
                const pos = acc.positions[symbol];
                const newQty = pos.qty + qty;
                pos.avg = newQty > 0 ? ((pos.avg * pos.qty) + (price * qty)) / newQty : 0;
                pos.qty = newQty;
                acc.cash -= cost;
                acc.trades.push({time: new Date().toISOString(), side: 'BUY', symbol: symbol, qty: qty, price: price});
                msg('Bought ' + qty + ' ' + symbol + ' at $' + price);
            } else {
                const pos = acc.positions[symbol];
                if (!pos || pos.qty === 0) return msg('No ' + symbol + ' to sell', 'error');
                if (qty > pos.qty) return msg('Only have ' + pos.qty, 'error');

                pos.qty -= qty;
                acc.cash += price * qty;
                acc.trades.push({time: new Date().toISOString(), side: 'SELL', symbol: symbol, qty: qty, price: price});
                msg('Sold ' + qty + ' ' + symbol + ' at $' + price);
            }
            saveAccount(acc);
            update();
        }

        function createChart() {
            const d = data[symbol];
            const ctx = document.getElementById('chart').getContext('2d');
            if (chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: d.dates,
                    datasets: [{ 
                        label: symbol, 
                        data: d.prices, 
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        fill: true 
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toFixed(2);
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: window.innerWidth < 768 ? 'bottom' : 'top'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            callbacks: {
                                label: function(context) {
                                    return symbol + ': $' + context.parsed.y.toFixed(2);
                                }
                            }
                        }
                    }
                }
            });
        }

        function reset() {
            if (confirm('Reset account to $100,000?')) {
                localStorage.removeItem('account');
                update();
                msg('Reset complete!');
            }
        }

        document.getElementById('symbol').onchange = function(e) {
            symbol = e.target.value;
            createChart();
            update();
        };

        window.onload = function() {
            createChart();
            update();
            msg('Welcome! You have $100,000 to trade.');
        };
    </script>
</body>
</html>
